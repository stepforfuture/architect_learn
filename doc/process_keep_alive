1、系统在什么时候，杀掉进程？

系统出于体验和性能上的优化，app在退到后台时系统不会真正的kill掉进程，而且将其缓存起来。

打开的应用越多，后台缓存的进程也就越多。

在系统内存不足的情况下，系统开始根据自己的一套进程回收机制来判断要kill掉哪些进程，以腾出内存来给需要的app，这套进程回收机制就叫 Low Memory killer:

Low Memory killer 主要是根据进程的优先级去杀掉进程。

2、进程的优先级

     前台进程               关键优先级

     可见进程               高优先级
     服务进程

     后台进程               低优先级
     空进程

 可见进程： 没有任何前台组件，但是会影响到用户在屏幕上所见内容的进程（activity启动dialog，activity所在进程）

 服务进程： 在后台运行服务的进程。

 后台进程：

 空进程：不含有任何活动应用组件的进程(缓存作用)

3、Low Memory killer何时去杀死进程？(进程被杀条件)

由内存阈值决定，内存阈值在不同手机上不一样，一旦低于内存阈值的时候，android便会杀死对应优先级的进程，例如当内存小于315Mb的时候就杀死空进程

查看内存阈值 利用命令cat /sys/module/lowmemory/killer/parameters/minfree 查看

如下
root@d1500a_01:/sys/module/lowmemorykiller/parameters # cat minfree
12288,15360,18432,21504,24576,30720

可以看到结果为"12288,15360,18432,21504,24576,30720" (单位是4kb)

这个结果的意思是当内存
小于 12288  kill 前台进程
小于 15360  kill 可见进程
小于 18432  kill 服务进程
小于 21504  kill 后台进程
小于 24576  kill contentProvider
小于 30720  kill 空进程

4、如何判断进程的优先级

使用命令 cat /proc/pid(进程id)/oom_adj

如

root@d1500a_01:/ # cat /proc/28530/oom_adj
0

进程adj为0表示 前台进程

按下home键再次执行命令
root@d1500a_01:/ # cat /proc/28530/oom_adj
2
进程的adj值为2了,2为可见进程(可感知进程)

关闭屏幕
root@d1500a_01:/ # cat /proc/28530/oom_adj
7
进程的adj值为7，一般表示上一个app进程


5.如果保活

其实就是提高进程优先级(降低进程的adj值)


方案1  1个像素的保活方案 见代码

局限性：activity不够干净，同时也需要在锁屏后才能提权

方案2  前台服务进行保活，提升进程的优先级,打开应用的时候打开一个服务

6.进程的拉活

广播
sticky 拉活
账号拉活



























